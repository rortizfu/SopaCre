create table TBL_RLETTERS_SOUP
(
SOP_NID BIGINT IDENTITY(1,1) PRIMARY KEY,
SOP_CDESCRIPTION VARCHAR(255),
SOP_CHTML XML,
SOP_OSTATE BIT
)

GO

CREATE TABLE TBL_RWORDS_SOUP
(
WOR_NID BIGINT IDENTITY(1,1) PRIMARY KEY,
SOP_NID BIGINT NOT NULL,
WOR_CWORD VARCHAR(255) NOT NULL,
WOR_OSTATE BIT
)

GO

CREATE PROCEDURE SPR_INS_WORDS_SOUP
@PI_NSOP_NID bigint,
@PI_CWOR_CWORD varchar(255),
@PI_OWOR_OSTATE bit,
@PO_NWOR_NID BIGINT = NULL 
AS
BEGIN
	INSERT INTO [TEST].[dbo].[TBL_RWORDS_SOUP]
           ([SOP_NID]
           ,[WOR_CWORD]
           ,[WOR_OSTATE])
     VALUES
           (@PI_NSOP_NID
           ,@PI_CWOR_CWORD
           ,@PI_OWOR_OSTATE)
     
     SET @PO_NWOR_NID = SCOPE_IDENTITY()
     
     RETURN @PO_NWOR_NID
END
GO


CREATE PROCEDURE SPR_IU_LETTERS_SOUP
@PI_CSOP_CDESCRIPTION VARCHAR(255),
@PI_XSOP_CHTML XML,
@PI_OSOP_OSTATE BIT,
@PO_NSOP_NID BIGINT = NULL OUTPUT
AS
BEGIN
	INSERT INTO [TEST].[dbo].[TBL_RLETTERS_SOUP]
           (SOP_CDESCRIPTION
           ,[SOP_CHTML]
           ,[SOP_OSTATE])
     VALUES
           (@PI_CSOP_CDESCRIPTION
			,@PI_XSOP_CHTML
            ,@PI_OSOP_OSTATE)
     
     SET @PO_NSOP_NID = SCOPE_IDENTITY()
     
     RETURN @PO_NSOP_NID
END
GO

create procedure SPR_GET_LETTERS_SOUP
@PI_OSTATE BIT = NULL
AS
BEGIN
	SELECT [SOP_NID] SoupId
      ,[SOP_CDESCRIPTION] SoupDescription
      ,[SOP_CHTML] SoupChtml
      ,[SOP_OSTATE] SoupState
  FROM [TEST].[dbo].[TBL_RLETTERS_SOUP]
  WHERE SOP_OSTATE = ISNULL(@PI_OSTATE,SOP_OSTATE)
END
GO

CREATE PROCEDURE SPR_GET_WORDS_SOUP
@PI_OSTATE BIT = NULL
AS
BEGIN

	SELECT [WOR_NID] WordId
      ,[SOP_NID] SoupId
      ,[WOR_CWORD] Word
      ,[WOR_OSTATE] WordState
  FROM [TEST].[dbo].[TBL_RWORDS_SOUP]
  WHERE WOR_OSTATE = ISNULL(@PI_OSTATE, WOR_OSTATE)

END

